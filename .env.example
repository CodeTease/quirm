# --- Storage Config ---

# Option A: Standard R2 Endpoint (Recommended)
S3_ENDPOINT=https://<account_id>.r2.cloudflarestorage.com
S3_BUCKET=my-bucket
S3_USE_CUSTOM_DOMAIN=false

# Option B: Custom Domain (Your Case: cdn.teaserverse.online)
# S3_ENDPOINT=https://cdn.teaserverse.online
# S3_BUCKET=cdn
# Set this to TRUE to prevent "cdn.cdn.teaserverse.online" issue
# S3_USE_CUSTOM_DOMAIN=true

# MinIO/LocalStack users might need this instead:
S3_FORCE_PATH_STYLE=false # Set to true for MinIO/LocalStack

S3_REGION=auto
S3_ACCESS_KEY=your_access_key
S3_SECRET_KEY=your_secret_key
# Optional: Failover bucket for errors
# S3_BACKUP_BUCKET=my-backup-bucket

# --- App Config ---

PORT=8080
# Path to fallback image if key not found (optional)
# DEFAULT_IMAGE_PATH=./assets/placeholder.png

CACHE_DIR=./cache_data
CACHE_TTL_HOURS=24
CLEANUP_INTERVAL_MINS=60

# In-Memory Cache (L1)
MEMORY_CACHE_SIZE=100
# MEMORY_CACHE_LIMIT_BYTES=52428800 # 50MB

# --- Redis (Optional) ---
# Required for distributed rate limiting or L2 cache
# REDIS_ADDR=localhost:6379
# REDIS_PASSWORD=secret
# REDIS_DB=0

# --- Image Processing & Security ---

# URL Signature Secret (Required for production to prevent DDoS)
# If set, all requests with params must have a valid 's' signature
SECRET_KEY=your_random_secret_string

# Watermarking
# Path to local image file (PNG/JPG) to overlay
# WATERMARK_PATH=./assets/watermark.png
# Opacity: 0.0 (transparent) to 1.0 (opaque)
WATERMARK_OPACITY=0.5

# Max input image size in MB (Default: 20)
MAX_IMAGE_SIZE_MB=20

# --- Advanced Features ---

# Security: Allowed Domains (CORS/Referer Check)
# Comma-separated list of allowed domains (e.g., example.com,myapp.com)
# Leave empty to allow all.
ALLOWED_DOMAINS=

# Security: IP Allowlist
# Comma-separated CIDRs (e.g., 10.0.0.0/8,192.168.1.1/32)
# ALLOWED_CIDRS=

# Security: GeoIP
# Comma-separated list of allowed ISO country codes (e.g., US,VN)
# Requires 'CF-IPCountry' or 'X-Country-Code' header from your proxy.
# ALLOWED_COUNTRIES=

# Security: Rate Limiting
# Requests per second per IP (Default: 10)
RATE_LIMIT=10

# Presets (JSON Map)
# PRESETS='{"thumb": {"w": 150, "h": 150, "fit": "cover"}}'

# AI / Smart Crop
# AI_MODEL_PATH=./models/yolov8n-seg.onnx
# AI_MODEL_INPUT_NAME=images
# AI_MODEL_OUTPUT_NAME=output0

# Video Thumbnail Support
# Requires 'ffmpeg' installed on the system.
ENABLE_VIDEO_THUMBNAIL=false

# Face Detection Model Path
# Path to the pigo cascade file (default: facefinder)
FACE_FINDER_PATH=./facefinder

# --- Debugging ---

DEBUG=false # Set to true to enable debug logs

# --- Metrics & Tracing ---
ENABLE_METRICS=false # Set to true to enable Prometheus metrics endpoint
# OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
